"use strict";(self.webpackChunk_micro_snake_plugin_fruit=self.webpackChunk_micro_snake_plugin_fruit||[]).push([[77,927],{77:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("// ESM COMPAT FLAG\n__webpack_require__.r(__webpack_exports__);\n\n;// CONCATENATED MODULE: ../store/src/gameConstants.ts\nconst CONSTANTS = {\n    gridSize: 20,\n    tileSizeMultiplier: 0.9,\n    get tileSize() {\n        return this.gridSize * this.tileSizeMultiplier;\n    },\n    get canvasSize() {\n        return this.gridSize * this.gridSize;\n    },\n    get startPosition() {\n        return { x: this.gridSize / 2, y: this.gridSize / 2 };\n    },\n    startFps: 6,\n    startTailSize: 5\n};\nconst velocityByKeyCode = {\n    // these should really account for the tileSize\n    37: { x: -1, y: 0 },\n    38: { x: 0, y: -1 },\n    39: { x: 1, y: 0 },\n    40: { x: 0, y: 1 }\n};\n\n// EXTERNAL MODULE: consume shared module (default) mobx@^6.3.13 (singleton) (fallback: ../../node_modules/mobx/dist/mobx.esm.js)\nvar mobx_esm_js_ = __webpack_require__(217);\n// EXTERNAL MODULE: consume shared module (default) react@^17.0.2 (singleton) (fallback: ../../node_modules/react/index.js)\nvar index_js_ = __webpack_require__(927);\nvar index_js_default = /*#__PURE__*/__webpack_require__.n(index_js_);\n;// CONCATENATED MODULE: ../store/src/gameStore.ts\n\n\n\n// without configuring enforceActions it would be possible to modify any observable from anywhere\n(0,mobx_esm_js_.configure)({ enforceActions: 'observed' });\n// base class\nclass GameStore {\n    constructor() {\n        this.gridSize = CONSTANTS.gridSize;\n        // initial game state, player is centered with no velocity\n        this.playerPosition = CONSTANTS.startPosition;\n        this.velocity = {\n            x: 0,\n            y: 0\n        };\n        this.trail = [CONSTANTS.startPosition];\n        this.tailSize = CONSTANTS.startTailSize;\n        // housekeeping to control animation\n        this.running = false;\n        // use to control fps and therefore game speed\n        this.lastFrameTime = Date.now();\n        this.fps = CONSTANTS.startFps;\n        this.suspendGame = (0,mobx_esm_js_.action)(() => {\n            this.running = false;\n        });\n        this.startGame = () => {\n            this.running = true;\n            this.tick();\n        };\n        this.tick = () => {\n            // render loop control\n            if (this.running) {\n                requestAnimationFrame(() => this.tick());\n                const now = Date.now();\n                const elapsed = now - this.lastFrameTime;\n                // render speed control\n                if (elapsed > this.frameInterval) {\n                    this.lastFrameTime = now - (elapsed % this.frameInterval);\n                    this.updatePlayerPosition(this.playerPosition, this.velocity);\n                }\n            }\n        };\n        this.updatePlayerPosition = (0,mobx_esm_js_.action)(({ x: px, y: py }, { x: vx, y: vy }) => {\n            if (vx || vy) {\n                const newPlayerPosition = {\n                    x: px + vx,\n                    y: py + vy\n                };\n                if (newPlayerPosition.x < 0) {\n                    newPlayerPosition.x = this.gridSize - 1;\n                }\n                if (newPlayerPosition.x > this.gridSize - 1) {\n                    newPlayerPosition.x = 0;\n                }\n                if (newPlayerPosition.y < 0) {\n                    newPlayerPosition.y = this.gridSize - 1;\n                }\n                if (newPlayerPosition.y > this.gridSize - 1) {\n                    newPlayerPosition.y = 0;\n                }\n                this.playerPosition = newPlayerPosition;\n                this.trail = this.trail.concat(newPlayerPosition).slice(-this.tailSize);\n            }\n        });\n        this.setVelocity = (0,mobx_esm_js_.action)((newVelocity) => {\n            this.velocity = newVelocity;\n        });\n        this.setTailSize = (0,mobx_esm_js_.action)((tailSize) => {\n            this.tailSize = tailSize;\n        });\n        this.setFPS = (0,mobx_esm_js_.action)((fps) => {\n            this.fps = fps;\n        });\n        this.setPlayerPosition = (0,mobx_esm_js_.action)((newPlayerPosition) => {\n            this.playerPosition = newPlayerPosition;\n        });\n        this.getRandomPosition = () => ({\n            x: Math.floor(Math.random() * this.gridSize),\n            y: Math.floor(Math.random() * this.gridSize)\n        });\n        (0,mobx_esm_js_.makeObservable)(this, {\n            playerPosition: mobx_esm_js_.observable,\n            trail: mobx_esm_js_.observable,\n            tailSize: mobx_esm_js_.observable,\n            frameInterval: mobx_esm_js_.computed,\n            score: mobx_esm_js_.computed,\n            running: mobx_esm_js_.observable\n        });\n        // setup lazy observables\n        (0,mobx_esm_js_.onBecomeObserved)(this, 'playerPosition', this.startGame);\n        (0,mobx_esm_js_.onBecomeUnobserved)(this, 'playerPosition', this.suspendGame);\n    }\n    get frameInterval() {\n        return 1000 / this.fps;\n    }\n    get score() {\n        return this.tailSize - CONSTANTS.startTailSize;\n    }\n}\n// all references should point to this singleton.\n// If store is accessed outside of useContext (e.g. outside of React) you need to use this instance (unless you want multiple stores)!\nconst GameStoreInstance = new GameStore();\nconst GameStoreContext = (0,index_js_.createContext)(GameStoreInstance);\n\n;// CONCATENATED MODULE: ../store/src/lazyPluginProvider.tsx\nvar __rest = (undefined && undefined.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\n\nconst LazyPluginProvider = (_a) => {\n    var { Plugin, asyncLoad } = _a, rest = __rest(_a, [\"Plugin\", \"asyncLoad\"]);\n    const [gameStore, setGameStore] = index_js_default().useState(null);\n    index_js_default().useEffect(() => {\n        asyncLoad().then((module) => setGameStore(module.GameStoreInstance));\n    }, []);\n    return gameStore ? index_js_default().createElement(Plugin, Object.assign({ gameStore: gameStore }, rest)) : null;\n};\n\n;// CONCATENATED MODULE: ../store/src/index.ts\n\n\n\n\n;// CONCATENATED MODULE: ../store/index.ts\n\n\n// EXTERNAL MODULE: ../../node_modules/react-dom/index.js\nvar react_dom = __webpack_require__(316);\n// EXTERNAL MODULE: consume shared module (default) react-konva@^17.0.2-5 (singleton) (fallback: ../../node_modules/react-konva/es/ReactKonva.js)\nvar ReactKonva_js_ = __webpack_require__(641);\n// EXTERNAL MODULE: consume shared module (default) mobx-react@^7.2.1 (singleton) (fallback: ../../node_modules/mobx-react/dist/mobxreact.esm.js)\nvar mobxreact_esm_js_ = __webpack_require__(189);\n;// CONCATENATED MODULE: ./src/components/apple/apple.tsx\n\n\n\n\nconst Apple = (0,mobxreact_esm_js_.observer)(function ({ gameStore }) {\n    const { playerPosition, tailSize, setTailSize, setFPS, getRandomPosition } = gameStore;\n    const [applePosition, setApplePosition] = index_js_default().useState(getRandomPosition());\n    index_js_default().useEffect(() => {\n        if (applePosition.x === playerPosition.x &&\n            applePosition.y === playerPosition.y) {\n            setTailSize(tailSize + 1);\n            setApplePosition(getRandomPosition());\n            setFPS(gameStore.fps + 1);\n        }\n    }, [applePosition, playerPosition]);\n    return (index_js_default().createElement(ReactKonva_js_.Layer, null,\n        index_js_default().createElement(ReactKonva_js_.Rect, { fill: 'red', width: CONSTANTS.tileSize, height: CONSTANTS.tileSize, x: applePosition.x * CONSTANTS.gridSize, y: applePosition.y * CONSTANTS.gridSize })));\n});\n/* harmony default export */ const apple = (Apple);\n\n;// CONCATENATED MODULE: ./src/components/plum/plum.tsx\n\n\n\n\nconst FPS_PENALTY = 2;\nconst PENALTY_TIMEOUT = 5000;\nconst PunishingPlum = (0,mobxreact_esm_js_.observer)(function ({ gameStore }) {\n    const { playerPosition, setFPS, getRandomPosition } = gameStore;\n    const [plumPosition, setPlumPosition] = index_js_default().useState(getRandomPosition());\n    index_js_default().useEffect(() => {\n        if (plumPosition.x === playerPosition.x &&\n            plumPosition.y === playerPosition.y) {\n            // move the plum\n            setPlumPosition(getRandomPosition);\n            // penalize by increasing speed\n            setFPS(gameStore.fps + FPS_PENALTY);\n            // eventually remove the penalty\n            setTimeout(() => setFPS(gameStore.fps - FPS_PENALTY), PENALTY_TIMEOUT);\n        }\n    }, [plumPosition, playerPosition]);\n    return (index_js_default().createElement(ReactKonva_js_.Rect, { stroke: 'purple', width: CONSTANTS.tileSize, height: CONSTANTS.tileSize, x: plumPosition.x * CONSTANTS.gridSize, y: plumPosition.y * CONSTANTS.gridSize }));\n});\n/* harmony default export */ const plum = (PunishingPlum);\n\n;// CONCATENATED MODULE: ./src/components/plum/plumContainer.tsx\n\n\n\n\nconst MIN_PLUMS = 1;\nconst PLUM_SCORE_MULTIPLIER = 0.25;\nconst PlumContainer = (0,mobxreact_esm_js_.observer)(function ({ gameStore }) {\n    const { score } = gameStore;\n    const plums = index_js_default().useMemo(() => Array.from(Array(Math.max(Math.ceil(score * PLUM_SCORE_MULTIPLIER), MIN_PLUMS)), () => index_js_default().createElement(plum, { gameStore: gameStore })), [score]);\n    return (index_js_default().createElement(ReactKonva_js_.Layer, null, plums));\n});\n/* harmony default export */ const plumContainer = (PlumContainer);\n\n;// CONCATENATED MODULE: ./bootstrap.tsx\n\n\n\n\n\n\nconst storePromise = __webpack_require__.e(/* import() */ 700).then(__webpack_require__.t.bind(__webpack_require__, 700, 23));\nreact_dom.render(index_js_default().createElement(ReactKonva_js_.Stage, { width: CONSTANTS.canvasSize, height: CONSTANTS.canvasSize },\n    index_js_default().createElement(LazyPluginProvider, { Plugin: apple, asyncLoad: () => storePromise }),\n    index_js_default().createElement(LazyPluginProvider, { Plugin: plumContainer, asyncLoad: () => storePromise })), document.getElementById('root'));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNzcuanMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7OztBQ3JCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FDdEdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQ25CQTtBQUNBO0FBQ0E7OztBQ0ZBOzs7Ozs7Ozs7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FDbEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQ3RCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQ1hBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vQG1pY3JvLXNuYWtlL3BsdWdpbi1mcnVpdC8uLi9zdG9yZS9zcmMvZ2FtZUNvbnN0YW50cy50cz85MjQ1Iiwid2VicGFjazovL0BtaWNyby1zbmFrZS9wbHVnaW4tZnJ1aXQvLi4vc3RvcmUvc3JjL2dhbWVTdG9yZS50cz82ZTQ5Iiwid2VicGFjazovL0BtaWNyby1zbmFrZS9wbHVnaW4tZnJ1aXQvLi4vc3RvcmUvc3JjL2xhenlQbHVnaW5Qcm92aWRlci50c3g/NGMwZiIsIndlYnBhY2s6Ly9AbWljcm8tc25ha2UvcGx1Z2luLWZydWl0Ly4uL3N0b3JlL3NyYy9pbmRleC50cz8zM2MzIiwid2VicGFjazovL0BtaWNyby1zbmFrZS9wbHVnaW4tZnJ1aXQvLi4vc3RvcmUvaW5kZXgudHM/ZTAxMyIsIndlYnBhY2s6Ly9AbWljcm8tc25ha2UvcGx1Z2luLWZydWl0Ly4vc3JjL2NvbXBvbmVudHMvYXBwbGUvYXBwbGUudHN4P2ViOTYiLCJ3ZWJwYWNrOi8vQG1pY3JvLXNuYWtlL3BsdWdpbi1mcnVpdC8uL3NyYy9jb21wb25lbnRzL3BsdW0vcGx1bS50c3g/MGFjYyIsIndlYnBhY2s6Ly9AbWljcm8tc25ha2UvcGx1Z2luLWZydWl0Ly4vc3JjL2NvbXBvbmVudHMvcGx1bS9wbHVtQ29udGFpbmVyLnRzeD84M2U2Iiwid2VicGFjazovL0BtaWNyby1zbmFrZS9wbHVnaW4tZnJ1aXQvLi9ib290c3RyYXAudHN4PzIyMmYiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNvbnN0IENPTlNUQU5UUyA9IHtcbiAgICBncmlkU2l6ZTogMjAsXG4gICAgdGlsZVNpemVNdWx0aXBsaWVyOiAwLjksXG4gICAgZ2V0IHRpbGVTaXplKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5ncmlkU2l6ZSAqIHRoaXMudGlsZVNpemVNdWx0aXBsaWVyO1xuICAgIH0sXG4gICAgZ2V0IGNhbnZhc1NpemUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdyaWRTaXplICogdGhpcy5ncmlkU2l6ZTtcbiAgICB9LFxuICAgIGdldCBzdGFydFBvc2l0aW9uKCkge1xuICAgICAgICByZXR1cm4geyB4OiB0aGlzLmdyaWRTaXplIC8gMiwgeTogdGhpcy5ncmlkU2l6ZSAvIDIgfTtcbiAgICB9LFxuICAgIHN0YXJ0RnBzOiA2LFxuICAgIHN0YXJ0VGFpbFNpemU6IDVcbn07XG5leHBvcnQgY29uc3QgdmVsb2NpdHlCeUtleUNvZGUgPSB7XG4gICAgLy8gdGhlc2Ugc2hvdWxkIHJlYWxseSBhY2NvdW50IGZvciB0aGUgdGlsZVNpemVcbiAgICAzNzogeyB4OiAtMSwgeTogMCB9LFxuICAgIDM4OiB7IHg6IDAsIHk6IC0xIH0sXG4gICAgMzk6IHsgeDogMSwgeTogMCB9LFxuICAgIDQwOiB7IHg6IDAsIHk6IDEgfVxufTtcbiIsImltcG9ydCB7IGFjdGlvbiwgY29tcHV0ZWQsIGNvbmZpZ3VyZSwgbWFrZU9ic2VydmFibGUsIG9ic2VydmFibGUsIG9uQmVjb21lT2JzZXJ2ZWQsIG9uQmVjb21lVW5vYnNlcnZlZCB9IGZyb20gJ21vYngnO1xuaW1wb3J0IHsgY3JlYXRlQ29udGV4dCB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IENPTlNUQU5UUyB9IGZyb20gJy4vZ2FtZUNvbnN0YW50cyc7XG4vLyB3aXRob3V0IGNvbmZpZ3VyaW5nIGVuZm9yY2VBY3Rpb25zIGl0IHdvdWxkIGJlIHBvc3NpYmxlIHRvIG1vZGlmeSBhbnkgb2JzZXJ2YWJsZSBmcm9tIGFueXdoZXJlXG5jb25maWd1cmUoeyBlbmZvcmNlQWN0aW9uczogJ29ic2VydmVkJyB9KTtcbi8vIGJhc2UgY2xhc3NcbmV4cG9ydCBjbGFzcyBHYW1lU3RvcmUge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLmdyaWRTaXplID0gQ09OU1RBTlRTLmdyaWRTaXplO1xuICAgICAgICAvLyBpbml0aWFsIGdhbWUgc3RhdGUsIHBsYXllciBpcyBjZW50ZXJlZCB3aXRoIG5vIHZlbG9jaXR5XG4gICAgICAgIHRoaXMucGxheWVyUG9zaXRpb24gPSBDT05TVEFOVFMuc3RhcnRQb3NpdGlvbjtcbiAgICAgICAgdGhpcy52ZWxvY2l0eSA9IHtcbiAgICAgICAgICAgIHg6IDAsXG4gICAgICAgICAgICB5OiAwXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMudHJhaWwgPSBbQ09OU1RBTlRTLnN0YXJ0UG9zaXRpb25dO1xuICAgICAgICB0aGlzLnRhaWxTaXplID0gQ09OU1RBTlRTLnN0YXJ0VGFpbFNpemU7XG4gICAgICAgIC8vIGhvdXNla2VlcGluZyB0byBjb250cm9sIGFuaW1hdGlvblxuICAgICAgICB0aGlzLnJ1bm5pbmcgPSBmYWxzZTtcbiAgICAgICAgLy8gdXNlIHRvIGNvbnRyb2wgZnBzIGFuZCB0aGVyZWZvcmUgZ2FtZSBzcGVlZFxuICAgICAgICB0aGlzLmxhc3RGcmFtZVRpbWUgPSBEYXRlLm5vdygpO1xuICAgICAgICB0aGlzLmZwcyA9IENPTlNUQU5UUy5zdGFydEZwcztcbiAgICAgICAgdGhpcy5zdXNwZW5kR2FtZSA9IGFjdGlvbigoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnJ1bm5pbmcgPSBmYWxzZTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuc3RhcnRHYW1lID0gKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5ydW5uaW5nID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMudGljaygpO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLnRpY2sgPSAoKSA9PiB7XG4gICAgICAgICAgICAvLyByZW5kZXIgbG9vcCBjb250cm9sXG4gICAgICAgICAgICBpZiAodGhpcy5ydW5uaW5nKSB7XG4gICAgICAgICAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHRoaXMudGljaygpKTtcbiAgICAgICAgICAgICAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGVsYXBzZWQgPSBub3cgLSB0aGlzLmxhc3RGcmFtZVRpbWU7XG4gICAgICAgICAgICAgICAgLy8gcmVuZGVyIHNwZWVkIGNvbnRyb2xcbiAgICAgICAgICAgICAgICBpZiAoZWxhcHNlZCA+IHRoaXMuZnJhbWVJbnRlcnZhbCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmxhc3RGcmFtZVRpbWUgPSBub3cgLSAoZWxhcHNlZCAlIHRoaXMuZnJhbWVJbnRlcnZhbCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlUGxheWVyUG9zaXRpb24odGhpcy5wbGF5ZXJQb3NpdGlvbiwgdGhpcy52ZWxvY2l0eSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICB0aGlzLnVwZGF0ZVBsYXllclBvc2l0aW9uID0gYWN0aW9uKCh7IHg6IHB4LCB5OiBweSB9LCB7IHg6IHZ4LCB5OiB2eSB9KSA9PiB7XG4gICAgICAgICAgICBpZiAodnggfHwgdnkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBuZXdQbGF5ZXJQb3NpdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgeDogcHggKyB2eCxcbiAgICAgICAgICAgICAgICAgICAgeTogcHkgKyB2eVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgaWYgKG5ld1BsYXllclBvc2l0aW9uLnggPCAwKSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld1BsYXllclBvc2l0aW9uLnggPSB0aGlzLmdyaWRTaXplIC0gMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKG5ld1BsYXllclBvc2l0aW9uLnggPiB0aGlzLmdyaWRTaXplIC0gMSkge1xuICAgICAgICAgICAgICAgICAgICBuZXdQbGF5ZXJQb3NpdGlvbi54ID0gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKG5ld1BsYXllclBvc2l0aW9uLnkgPCAwKSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld1BsYXllclBvc2l0aW9uLnkgPSB0aGlzLmdyaWRTaXplIC0gMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKG5ld1BsYXllclBvc2l0aW9uLnkgPiB0aGlzLmdyaWRTaXplIC0gMSkge1xuICAgICAgICAgICAgICAgICAgICBuZXdQbGF5ZXJQb3NpdGlvbi55ID0gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5wbGF5ZXJQb3NpdGlvbiA9IG5ld1BsYXllclBvc2l0aW9uO1xuICAgICAgICAgICAgICAgIHRoaXMudHJhaWwgPSB0aGlzLnRyYWlsLmNvbmNhdChuZXdQbGF5ZXJQb3NpdGlvbikuc2xpY2UoLXRoaXMudGFpbFNpemUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5zZXRWZWxvY2l0eSA9IGFjdGlvbigobmV3VmVsb2NpdHkpID0+IHtcbiAgICAgICAgICAgIHRoaXMudmVsb2NpdHkgPSBuZXdWZWxvY2l0eTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuc2V0VGFpbFNpemUgPSBhY3Rpb24oKHRhaWxTaXplKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnRhaWxTaXplID0gdGFpbFNpemU7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnNldEZQUyA9IGFjdGlvbigoZnBzKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmZwcyA9IGZwcztcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuc2V0UGxheWVyUG9zaXRpb24gPSBhY3Rpb24oKG5ld1BsYXllclBvc2l0aW9uKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnBsYXllclBvc2l0aW9uID0gbmV3UGxheWVyUG9zaXRpb247XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmdldFJhbmRvbVBvc2l0aW9uID0gKCkgPT4gKHtcbiAgICAgICAgICAgIHg6IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHRoaXMuZ3JpZFNpemUpLFxuICAgICAgICAgICAgeTogTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogdGhpcy5ncmlkU2l6ZSlcbiAgICAgICAgfSk7XG4gICAgICAgIG1ha2VPYnNlcnZhYmxlKHRoaXMsIHtcbiAgICAgICAgICAgIHBsYXllclBvc2l0aW9uOiBvYnNlcnZhYmxlLFxuICAgICAgICAgICAgdHJhaWw6IG9ic2VydmFibGUsXG4gICAgICAgICAgICB0YWlsU2l6ZTogb2JzZXJ2YWJsZSxcbiAgICAgICAgICAgIGZyYW1lSW50ZXJ2YWw6IGNvbXB1dGVkLFxuICAgICAgICAgICAgc2NvcmU6IGNvbXB1dGVkLFxuICAgICAgICAgICAgcnVubmluZzogb2JzZXJ2YWJsZVxuICAgICAgICB9KTtcbiAgICAgICAgLy8gc2V0dXAgbGF6eSBvYnNlcnZhYmxlc1xuICAgICAgICBvbkJlY29tZU9ic2VydmVkKHRoaXMsICdwbGF5ZXJQb3NpdGlvbicsIHRoaXMuc3RhcnRHYW1lKTtcbiAgICAgICAgb25CZWNvbWVVbm9ic2VydmVkKHRoaXMsICdwbGF5ZXJQb3NpdGlvbicsIHRoaXMuc3VzcGVuZEdhbWUpO1xuICAgIH1cbiAgICBnZXQgZnJhbWVJbnRlcnZhbCgpIHtcbiAgICAgICAgcmV0dXJuIDEwMDAgLyB0aGlzLmZwcztcbiAgICB9XG4gICAgZ2V0IHNjb3JlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy50YWlsU2l6ZSAtIENPTlNUQU5UUy5zdGFydFRhaWxTaXplO1xuICAgIH1cbn1cbi8vIGFsbCByZWZlcmVuY2VzIHNob3VsZCBwb2ludCB0byB0aGlzIHNpbmdsZXRvbi5cbi8vIElmIHN0b3JlIGlzIGFjY2Vzc2VkIG91dHNpZGUgb2YgdXNlQ29udGV4dCAoZS5nLiBvdXRzaWRlIG9mIFJlYWN0KSB5b3UgbmVlZCB0byB1c2UgdGhpcyBpbnN0YW5jZSAodW5sZXNzIHlvdSB3YW50IG11bHRpcGxlIHN0b3JlcykhXG5leHBvcnQgY29uc3QgR2FtZVN0b3JlSW5zdGFuY2UgPSBuZXcgR2FtZVN0b3JlKCk7XG5leHBvcnQgY29uc3QgR2FtZVN0b3JlQ29udGV4dCA9IGNyZWF0ZUNvbnRleHQoR2FtZVN0b3JlSW5zdGFuY2UpO1xuIiwidmFyIF9fcmVzdCA9ICh0aGlzICYmIHRoaXMuX19yZXN0KSB8fCBmdW5jdGlvbiAocywgZSkge1xuICAgIHZhciB0ID0ge307XG4gICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApICYmIGUuaW5kZXhPZihwKSA8IDApXG4gICAgICAgIHRbcF0gPSBzW3BdO1xuICAgIGlmIChzICE9IG51bGwgJiYgdHlwZW9mIE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMgPT09IFwiZnVuY3Rpb25cIilcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIHAgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKHMpOyBpIDwgcC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKGUuaW5kZXhPZihwW2ldKSA8IDAgJiYgT2JqZWN0LnByb3RvdHlwZS5wcm9wZXJ0eUlzRW51bWVyYWJsZS5jYWxsKHMsIHBbaV0pKVxuICAgICAgICAgICAgICAgIHRbcFtpXV0gPSBzW3BbaV1dO1xuICAgICAgICB9XG4gICAgcmV0dXJuIHQ7XG59O1xuaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcbmV4cG9ydCBjb25zdCBMYXp5UGx1Z2luUHJvdmlkZXIgPSAoX2EpID0+IHtcbiAgICB2YXIgeyBQbHVnaW4sIGFzeW5jTG9hZCB9ID0gX2EsIHJlc3QgPSBfX3Jlc3QoX2EsIFtcIlBsdWdpblwiLCBcImFzeW5jTG9hZFwiXSk7XG4gICAgY29uc3QgW2dhbWVTdG9yZSwgc2V0R2FtZVN0b3JlXSA9IFJlYWN0LnVzZVN0YXRlKG51bGwpO1xuICAgIFJlYWN0LnVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgIGFzeW5jTG9hZCgpLnRoZW4oKG1vZHVsZSkgPT4gc2V0R2FtZVN0b3JlKG1vZHVsZS5HYW1lU3RvcmVJbnN0YW5jZSkpO1xuICAgIH0sIFtdKTtcbiAgICByZXR1cm4gZ2FtZVN0b3JlID8gUmVhY3QuY3JlYXRlRWxlbWVudChQbHVnaW4sIE9iamVjdC5hc3NpZ24oeyBnYW1lU3RvcmU6IGdhbWVTdG9yZSB9LCByZXN0KSkgOiBudWxsO1xufTtcbiIsImV4cG9ydCAqIGZyb20gJy4vZ2FtZUNvbnN0YW50cyc7XG5leHBvcnQgKiBmcm9tICcuL2dhbWVTdG9yZSc7XG5leHBvcnQgKiBmcm9tICcuL2xhenlQbHVnaW5Qcm92aWRlcic7XG4iLCJleHBvcnQgKiBmcm9tICcuL3NyYyc7XG4iLCJpbXBvcnQgeyBDT05TVEFOVFMgYXMgR2FtZUNvbnN0YW50cyB9IGZyb20gJ0BtaWNyby1zbmFrZS9lbmdpbmUnO1xuaW1wb3J0IHsgb2JzZXJ2ZXIgfSBmcm9tICdtb2J4LXJlYWN0JztcbmltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBMYXllciwgUmVjdCB9IGZyb20gJ3JlYWN0LWtvbnZhJztcbmNvbnN0IEFwcGxlID0gb2JzZXJ2ZXIoZnVuY3Rpb24gKHsgZ2FtZVN0b3JlIH0pIHtcbiAgICBjb25zdCB7IHBsYXllclBvc2l0aW9uLCB0YWlsU2l6ZSwgc2V0VGFpbFNpemUsIHNldEZQUywgZ2V0UmFuZG9tUG9zaXRpb24gfSA9IGdhbWVTdG9yZTtcbiAgICBjb25zdCBbYXBwbGVQb3NpdGlvbiwgc2V0QXBwbGVQb3NpdGlvbl0gPSBSZWFjdC51c2VTdGF0ZShnZXRSYW5kb21Qb3NpdGlvbigpKTtcbiAgICBSZWFjdC51c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICBpZiAoYXBwbGVQb3NpdGlvbi54ID09PSBwbGF5ZXJQb3NpdGlvbi54ICYmXG4gICAgICAgICAgICBhcHBsZVBvc2l0aW9uLnkgPT09IHBsYXllclBvc2l0aW9uLnkpIHtcbiAgICAgICAgICAgIHNldFRhaWxTaXplKHRhaWxTaXplICsgMSk7XG4gICAgICAgICAgICBzZXRBcHBsZVBvc2l0aW9uKGdldFJhbmRvbVBvc2l0aW9uKCkpO1xuICAgICAgICAgICAgc2V0RlBTKGdhbWVTdG9yZS5mcHMgKyAxKTtcbiAgICAgICAgfVxuICAgIH0sIFthcHBsZVBvc2l0aW9uLCBwbGF5ZXJQb3NpdGlvbl0pO1xuICAgIHJldHVybiAoUmVhY3QuY3JlYXRlRWxlbWVudChMYXllciwgbnVsbCxcbiAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChSZWN0LCB7IGZpbGw6ICdyZWQnLCB3aWR0aDogR2FtZUNvbnN0YW50cy50aWxlU2l6ZSwgaGVpZ2h0OiBHYW1lQ29uc3RhbnRzLnRpbGVTaXplLCB4OiBhcHBsZVBvc2l0aW9uLnggKiBHYW1lQ29uc3RhbnRzLmdyaWRTaXplLCB5OiBhcHBsZVBvc2l0aW9uLnkgKiBHYW1lQ29uc3RhbnRzLmdyaWRTaXplIH0pKSk7XG59KTtcbmV4cG9ydCBkZWZhdWx0IEFwcGxlO1xuIiwiaW1wb3J0IHsgQ09OU1RBTlRTIH0gZnJvbSAnQG1pY3JvLXNuYWtlL2VuZ2luZSc7XG5pbXBvcnQgeyBvYnNlcnZlciB9IGZyb20gJ21vYngtcmVhY3QnO1xuaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IFJlY3QgfSBmcm9tICdyZWFjdC1rb252YSc7XG5jb25zdCBGUFNfUEVOQUxUWSA9IDI7XG5jb25zdCBQRU5BTFRZX1RJTUVPVVQgPSA1MDAwO1xuY29uc3QgUHVuaXNoaW5nUGx1bSA9IG9ic2VydmVyKGZ1bmN0aW9uICh7IGdhbWVTdG9yZSB9KSB7XG4gICAgY29uc3QgeyBwbGF5ZXJQb3NpdGlvbiwgc2V0RlBTLCBnZXRSYW5kb21Qb3NpdGlvbiB9ID0gZ2FtZVN0b3JlO1xuICAgIGNvbnN0IFtwbHVtUG9zaXRpb24sIHNldFBsdW1Qb3NpdGlvbl0gPSBSZWFjdC51c2VTdGF0ZShnZXRSYW5kb21Qb3NpdGlvbigpKTtcbiAgICBSZWFjdC51c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICBpZiAocGx1bVBvc2l0aW9uLnggPT09IHBsYXllclBvc2l0aW9uLnggJiZcbiAgICAgICAgICAgIHBsdW1Qb3NpdGlvbi55ID09PSBwbGF5ZXJQb3NpdGlvbi55KSB7XG4gICAgICAgICAgICAvLyBtb3ZlIHRoZSBwbHVtXG4gICAgICAgICAgICBzZXRQbHVtUG9zaXRpb24oZ2V0UmFuZG9tUG9zaXRpb24pO1xuICAgICAgICAgICAgLy8gcGVuYWxpemUgYnkgaW5jcmVhc2luZyBzcGVlZFxuICAgICAgICAgICAgc2V0RlBTKGdhbWVTdG9yZS5mcHMgKyBGUFNfUEVOQUxUWSk7XG4gICAgICAgICAgICAvLyBldmVudHVhbGx5IHJlbW92ZSB0aGUgcGVuYWx0eVxuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiBzZXRGUFMoZ2FtZVN0b3JlLmZwcyAtIEZQU19QRU5BTFRZKSwgUEVOQUxUWV9USU1FT1VUKTtcbiAgICAgICAgfVxuICAgIH0sIFtwbHVtUG9zaXRpb24sIHBsYXllclBvc2l0aW9uXSk7XG4gICAgcmV0dXJuIChSZWFjdC5jcmVhdGVFbGVtZW50KFJlY3QsIHsgc3Ryb2tlOiAncHVycGxlJywgd2lkdGg6IENPTlNUQU5UUy50aWxlU2l6ZSwgaGVpZ2h0OiBDT05TVEFOVFMudGlsZVNpemUsIHg6IHBsdW1Qb3NpdGlvbi54ICogQ09OU1RBTlRTLmdyaWRTaXplLCB5OiBwbHVtUG9zaXRpb24ueSAqIENPTlNUQU5UUy5ncmlkU2l6ZSB9KSk7XG59KTtcbmV4cG9ydCBkZWZhdWx0IFB1bmlzaGluZ1BsdW07XG4iLCJpbXBvcnQgeyBvYnNlcnZlciB9IGZyb20gJ21vYngtcmVhY3QnO1xuaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IExheWVyIH0gZnJvbSAncmVhY3Qta29udmEnO1xuaW1wb3J0IFB1bmlzaGluZ1BsdW0gZnJvbSAnLi9wbHVtJztcbmNvbnN0IE1JTl9QTFVNUyA9IDE7XG5jb25zdCBQTFVNX1NDT1JFX01VTFRJUExJRVIgPSAwLjI1O1xuY29uc3QgUGx1bUNvbnRhaW5lciA9IG9ic2VydmVyKGZ1bmN0aW9uICh7IGdhbWVTdG9yZSB9KSB7XG4gICAgY29uc3QgeyBzY29yZSB9ID0gZ2FtZVN0b3JlO1xuICAgIGNvbnN0IHBsdW1zID0gUmVhY3QudXNlTWVtbygoKSA9PiBBcnJheS5mcm9tKEFycmF5KE1hdGgubWF4KE1hdGguY2VpbChzY29yZSAqIFBMVU1fU0NPUkVfTVVMVElQTElFUiksIE1JTl9QTFVNUykpLCAoKSA9PiBSZWFjdC5jcmVhdGVFbGVtZW50KFB1bmlzaGluZ1BsdW0sIHsgZ2FtZVN0b3JlOiBnYW1lU3RvcmUgfSkpLCBbc2NvcmVdKTtcbiAgICByZXR1cm4gKFJlYWN0LmNyZWF0ZUVsZW1lbnQoTGF5ZXIsIG51bGwsIHBsdW1zKSk7XG59KTtcbmV4cG9ydCBkZWZhdWx0IFBsdW1Db250YWluZXI7XG4iLCJpbXBvcnQgeyBDT05TVEFOVFMgYXMgR2FtZUNvbnN0YW50cywgTGF6eVBsdWdpblByb3ZpZGVyIH0gZnJvbSAnQG1pY3JvLXNuYWtlL2VuZ2luZSc7XG5pbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IFJlYWN0RE9NIGZyb20gJ3JlYWN0LWRvbSc7XG5pbXBvcnQgeyBTdGFnZSB9IGZyb20gJ3JlYWN0LWtvbnZhJztcbmltcG9ydCBBcHBsZSBmcm9tICcuL3NyYy9jb21wb25lbnRzL2FwcGxlL2FwcGxlJztcbmltcG9ydCBQbHVtcyBmcm9tICcuL3NyYy9jb21wb25lbnRzL3BsdW0vcGx1bUNvbnRhaW5lcic7XG5jb25zdCBzdG9yZVByb21pc2UgPSBpbXBvcnQoJ2VuZ2luZS9TdG9yZScpO1xuUmVhY3RET00ucmVuZGVyKFJlYWN0LmNyZWF0ZUVsZW1lbnQoU3RhZ2UsIHsgd2lkdGg6IEdhbWVDb25zdGFudHMuY2FudmFzU2l6ZSwgaGVpZ2h0OiBHYW1lQ29uc3RhbnRzLmNhbnZhc1NpemUgfSxcbiAgICBSZWFjdC5jcmVhdGVFbGVtZW50KExhenlQbHVnaW5Qcm92aWRlciwgeyBQbHVnaW46IEFwcGxlLCBhc3luY0xvYWQ6ICgpID0+IHN0b3JlUHJvbWlzZSB9KSxcbiAgICBSZWFjdC5jcmVhdGVFbGVtZW50KExhenlQbHVnaW5Qcm92aWRlciwgeyBQbHVnaW46IFBsdW1zLCBhc3luY0xvYWQ6ICgpID0+IHN0b3JlUHJvbWlzZSB9KSksIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyb290JykpO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///77\n")}}]);